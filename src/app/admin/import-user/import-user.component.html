<div mat-dialog-title>
  <h1> Hướng dẫn nhập bằng excel
  </h1>
  <div class="spacer"></div>
  <button mat-dialog-close="" mat-icon-button>
    <mat-icon>close</mat-icon>
  </button>
</div>

<div mat-dialog-content>
  <div *ngIf="!roles.length" class="loading">
    <mat-spinner></mat-spinner>
  </div>
  <mat-stepper #stepper *ngIf="roles.length" [linear]="true" orientation="vertical">
    <mat-step>
      <ng-template matStepLabel>Tải file template</ng-template>
      <div>Nhân vào đường link bên dưới để tải file excel và chỉnh sửa theo template</div>
      <a color="primary" href="https://drive.google.com/uc?export=download&id=1fIGL8jh8n5CcD-FJFt3Sqeqdv06w0W88" mat-icon-button>
        <mat-icon>download</mat-icon>
        <span>Tải template excel</span>
      </a>
      <div>
        <button mat-icon-button matStepperNext>
          <mat-icon>navigate_next</mat-icon>
          <span>tiếp theo</span></button>
      </div>
    </mat-step>
    <mat-step completed>
      <ng-template matStepLabel>Upload file excel</ng-template>
      <div>Upload lại file excel đã chỉnh sửa theo template và chọn Nhập. Hệ thống sẽ tự động download file kết quả</div>
      <div>
        <button (click)="openFileExplorer()" color="primary" mat-icon-button>
          <mat-icon>upload</mat-icon>
          <span>{{this.fileName ?? 'upload file excel'}}</span>
        </button>

      </div>

      <div>
        <button (click)="importDepartments()" [disabled]="!users.length" color="primary" mat-raised-button>Nhập</button>
      </div>

      <input (change)="addAttachment($event)"
             accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel" id="file-input"
             name="upload-file"
             style="visibility: hidden;height: 1px; width: 1px"
             type="file"
      >
    </mat-step>
  </mat-stepper>
</div>
